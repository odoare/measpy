<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial 2: measpy.Spectral class &mdash; measpy  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Tutorial 3: The measpy.Measurement class" href="3_measurements.html" />
    <link rel="prev" title="Tutorial 1: Play with the measpy.Signal class" href="1_play_with_signals.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> measpy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="copyright.html">Copyright</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_play_with_signals.html">Signal tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Spectral tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#units">Units</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="3_measurements.html">Measurement tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_spectrum_smoothing_and_weighting.html">Weighting and smoothing tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="measpy.html">measpy package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">measpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">Tutorial 2: measpy.Spectral class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/2_spectral_data.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial-2-measpy-spectral-class">
<h1>Tutorial 2: measpy.Spectral class<a class="headerlink" href="#tutorial-2-measpy-spectral-class" title="Permalink to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">measpy.Spectral</span></code> allows to do Fourier analyses on signals.</p>
<p>An object of the <code class="docutils literal notranslate"><span class="pre">Spectral</span></code> type contains the following maing properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fs</span></code> : a sampling frequency (int)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">desc</span></code> : a description (string)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code> : a physical unit (unyt.Unit)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code> : a 1D array (float) containing the values of the Fourier spectrum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">full</span></code> : a boolean value indicating if the spectrum values are given up to the sampling frequency <code class="docutils literal notranslate"><span class="pre">fs</span></code> or the Nyquist frequency <code class="docutils literal notranslate"><span class="pre">fs/2</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#This is here in case we want to use the local measy directory</span>
<span class="c1">#import sys</span>
<span class="c1">#sys.path.insert(0, &quot;..&quot;)</span>

<span class="kn">import</span> <span class="nn">measpy</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>Let us create a white noise signal of duration 5 seconds, with the sampling frequency <code class="docutils literal notranslate"><span class="pre">fs</span></code>=44100 Hz</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">noise</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">22050</span><span class="p">],</span><span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span><span class="n">dur</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span>
<span class="n">noise</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">measpy</span><span class="o">.</span><span class="n">Signal</span><span class="p">(</span><span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Noise 0-22050Hz&#39;</span><span class="p">,</span> <span class="n">cal</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;dimensionless&#39;</span><span class="p">,</span> <span class="n">dbfs</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>





<span class="o">&lt;</span><span class="n">AxesSubplot</span><span class="p">:</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><img alt="svg" src="_images/2_spectral_data_3_2.svg" /></p>
<p>Let us now filter this noise using the method <code class="docutils literal notranslate"><span class="pre">Signal.iir</span></code>, which is basically a wrapper function around <code class="docutils literal notranslate"><span class="pre">scipy.signal.filter.iirfilter</span></code> and <code class="docutils literal notranslate"><span class="pre">scipy.signal.filter.sosfilt</span></code>.</p>
<p>Below, the white noise is filtered between 1000 and 2000 Hz using a 6th-order butterworth filter (default type)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">noisef</span> <span class="o">=</span> <span class="n">noise</span><span class="o">.</span><span class="n">iir</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Wn</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span><span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We now calculate and plot the FFT</p>
<p>As the signal is real valued, it is fair to use the rfft, which only returns the (complex) values of the FFT up to the Nyquist frequency.</p>
<p>rfft is a method of <code class="docutils literal notranslate"><span class="pre">measpy.Signal</span></code> class, that returns an object of the <code class="docutils literal notranslate"><span class="pre">measpy.Spectral</span></code> class</p>
<p>By default, with no arguments, the plot method of the <code class="docutils literal notranslate"><span class="pre">Spectral</span></code> class plots the dB amplitude (ref. unity) and phase, with logarithmic frequency scale, and returns an array of two axes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">noisesp</span> <span class="o">=</span> <span class="n">noisef</span><span class="o">.</span><span class="n">rfft</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">noisesp</span><span class="p">)</span>
<span class="n">noisesp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">measpy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">Spectral</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f448a9e9fa0</span><span class="o">&gt;</span>





<span class="n">array</span><span class="p">([</span><span class="o">&lt;</span><span class="n">AxesSubplot</span><span class="p">:</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Freq (Hz)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;20 Log |H|&#39;</span><span class="o">&gt;</span><span class="p">,</span>
       <span class="o">&lt;</span><span class="n">AxesSubplot</span><span class="p">:</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Freq (Hz&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Phase&#39;</span><span class="o">&gt;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="svg" src="_images/2_spectral_data_7_2.svg" /></p>
<p>The <code class="docutils literal notranslate"><span class="pre">measpy.Spectral.irfft</span></code> method allows to go back the time domain…</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">noisesp</span><span class="o">.</span><span class="n">irfft</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">AxesSubplot</span><span class="p">:</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><img alt="svg" src="_images/2_spectral_data_9_1.svg" /></p>
<p>To commpute the frequency response of the filter, we can use Welch’s method for transfer function estimation.</p>
<p>Let us do this and compare with the “theoretical” frequency response given by <code class="docutils literal notranslate"><span class="pre">scipy.signal.sosfreqz</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">noisef</span><span class="o">.</span><span class="n">tfe_welch</span><span class="p">(</span><span class="n">noise</span><span class="p">,</span><span class="n">nperseg</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Welch&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">iirfilter</span><span class="p">,</span> <span class="n">sosfreqz</span>

<span class="n">sos</span> <span class="o">=</span> <span class="n">iirfilter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Wn</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">noise</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;sos&#39;</span><span class="p">,</span><span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="n">sosfreqz</span><span class="p">(</span><span class="n">sos</span><span class="p">,</span><span class="n">fs</span><span class="o">=</span><span class="n">noise</span><span class="o">.</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;freqz&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">20000</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;freqz&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">20000</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7f448b272ee0</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><img alt="svg" src="_images/2_spectral_data_11_1.svg" /></p>
<section id="units">
<h2>Units<a class="headerlink" href="#units" title="Permalink to this heading"></a></h2>
<p>Units are preserved during all the spectral/signal analyses.</p>
<p>To illustrate this, let us create a noise signal, in Volts, and another one in Pascals, and do some Fourier analyses with these signals.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># voltage signal</span>
<span class="n">voltage</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Signal</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">22050</span><span class="p">],</span><span class="n">fs</span><span class="o">=</span><span class="mi">44100</span><span class="p">,</span><span class="n">dur</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">similar</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>

<span class="c1"># Consider the pressure we have measured is linearly dependent</span>
<span class="c1"># on the voltage. In this example it is done with a filter, for</span>
<span class="c1"># instance a bandpass</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">voltage</span><span class="o">.</span><span class="n">iir</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">Wn</span><span class="o">=</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">3000</span><span class="p">],</span><span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span><span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;butter&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">similar</span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span>

<span class="n">v_fft</span> <span class="o">=</span> <span class="n">voltage</span><span class="o">.</span><span class="n">rfft</span><span class="p">()</span>
<span class="n">p_fft</span> <span class="o">=</span> <span class="n">pressure</span><span class="o">.</span><span class="n">rfft</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">v_fft</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_fft</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

<span class="n">a</span><span class="o">=</span><span class="n">v_fft</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">p_fft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">a</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span><span class="mi">20000</span><span class="p">])</span>
<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
<span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span><span class="mi">20000</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
<span class="n">Pa</span>





<span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20000</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="svg" src="_images/2_spectral_data_13_2.svg" /></p>
<p>Welch’s method for transfer function preserves units, as illustrated with the command below, which computes the transfer function between voltage and pressure. The resulting spectral data should have the dimension ‘Pa/V’.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tf</span><span class="o">=</span><span class="n">pressure</span><span class="o">.</span><span class="n">tfe_welch</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span><span class="n">nperseg</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pa</span><span class="o">/</span><span class="n">V</span>





<span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7f448b3b8cd0</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><img alt="svg" src="_images/2_spectral_data_15_2.svg" /></p>
<p>Spectral object can be added, multiplied, divided, etc., provided they have compatible sampling frequency, duration and units.</p>
<p>For instance, it is not allowed to add voltage and pressure spectra. This should raise an Exception.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">v_fft</span><span class="o">+</span><span class="n">p_fft</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">Exception</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">45</span><span class="o">-</span><span class="n">f71d479f840d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">v_fft</span><span class="o">+</span><span class="n">p_fft</span>


<span class="o">~/</span><span class="n">Documents</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">measpy</span><span class="o">/</span><span class="n">measpy</span><span class="o">/</span><span class="n">signal</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
   <span class="mi">1156</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">   1157         if type(other)==Spectral:</span>
<span class="s2">-&gt; 1158             return self._add(other)</span>
<span class="s2">   1159 </span>
<span class="s2">   1160         if (type(other)==float) or (type(other)==int):</span>


<span class="s2">~/Documents/python/measpy/measpy/signal.py in _add(self, other)</span>
<span class="s2">   1136 </span>
<span class="s2">   1137         if not self.unit.same_dimensions_as(other.unit):</span>
<span class="s2">-&gt; 1138             raise Exception(&#39;Incompatible units in addition of Spectral obk=jects&#39;)</span>
<span class="s2">   1139         if self.fs!=other.fs:</span>
<span class="s2">   1140             raise Exception(&#39;Incompatible sampling frequencies in addition of Spectral objects&#39;)</span>


<span class="s2">Exception: Incompatible units in addition of Spectral obk=jects</span>
</pre></div>
</div>
<p>It is however possible to multiply them (even if the reason to do this is questionnable…). The units are preserved during the operations</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prod</span> <span class="o">=</span> <span class="n">v_fft</span><span class="o">*</span><span class="n">p_fft</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prod</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pa</span><span class="o">*</span><span class="n">V</span>
</pre></div>
</div>
<p>When going back to time domain, the units are also preserved. For instance, we could compute the Green’s function of our LTI system that transforms voltage to pressure, whose transfer function has already been estimated previously (<code class="docutils literal notranslate"><span class="pre">tf</span></code> <code class="docutils literal notranslate"><span class="pre">Spectral</span></code> object).</p>
<p>As should appear in the plot below, the dimension of the Green’s function is now Pa/V</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">irfft</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">AxesSubplot</span><span class="p">:</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (s)&#39;</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><img alt="svg" src="_images/2_spectral_data_21_1.svg" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="1_play_with_signals.html" class="btn btn-neutral float-left" title="Tutorial 1: Play with the measpy.Signal class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="3_measurements.html" class="btn btn-neutral float-right" title="Tutorial 3: The measpy.Measurement class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; <a href="copyright.html">Copyright</a> 2021, Olivier Doaré.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>